---
title: "Cosine Similarity Between Two Embeddings"
format:
  html:
    allow-html: true
jupyter: python3
---
```{=html}
<!-- load Plotly -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<!-- container for the plot -->
<div id="plotly-container" style="margin-bottom:12px;"></div>

<!-- sliders -->
<div style="display:grid; grid-template-columns: repeat(2,1fr); gap:8px; max-width:520px;">
  <label>Vec1 X: <input id="x1" type="range" min="0" max="3" step="0.1" value="1.2"></label>
  <label>Vec1 Y: <input id="y1" type="range" min="0" max="3" step="0.1" value="2.4"></label>
  <label>Vec2 X: <input id="x2" type="range" min="0" max="3" step="0.1" value="2.0"></label>
  <label>Vec2 Y: <input id="y2" type="range" min="0" max="3" step="0.1" value="1.0"></label>
</div>

<script>
  function draw(x1,y1,x2,y2){
    const v1=[x1,y1], v2=[x2,y2],
          n1=Math.hypot(...v1), n2=Math.hypot(...v2),
          cos = (n1===0||n2===0)?0:
                Math.max(-1,Math.min(1,(v1[0]*v2[0]+v1[1]*v2[1])/(n1*n2))),
          theta=(n1*n2===0)?0:Math.acos(cos)*180/Math.PI;

    const traces=[
      { x:[0,x1], y:[0,y1], mode:'lines+markers',
        name:`v₁ (|v₁|=${n1.toFixed(2)})`,
        line:{color:'#1f78b4',width:2} },
      { x:[0,x2], y:[0,y2], mode:'lines+markers',
        name:`v₂ (|v₂|=${n2.toFixed(2)})`,
        line:{color:'#ff7f00',width:2} }
    ];
    if(n1>0 && n2>0 && Math.abs(Math.abs(cos)-1)>1e-6){
      const a1=Math.atan2(y1,x1), a2=Math.atan2(y2,x2),
            N=100, t=[];
      for(let i=0;i<=N;i++) t.push(a1 + (a2-a1)*i/N);
      traces.push({
        x:t.map(a=>0.5*Math.cos(a)),
        y:t.map(a=>0.5*Math.sin(a)),
        mode:'lines', name:'θ',
        line:{dash:'dot',color:'#33a02c'}
      });
    }

    const layout={
      title:`Cosine similarity = ${cos.toFixed(2)} | θ = ${theta.toFixed(1)}°`,
      width:520, height:520,
      xaxis:{range:[-0.2,3.2],zeroline:true,gridcolor:'lightgray'},
      yaxis:{range:[-0.2,3.2],zeroline:true,gridcolor:'lightgray'},
      plot_bgcolor:'white', paper_bgcolor:'white',
      showlegend:true,
      annotations: [
        {
          ax: 0, ay: 0, x: x1, y: y1,
          showarrow: true, arrowhead: 3, arrowsize: 1.2, arrowwidth: 2,
          arrowcolor: '#1f78b4', opacity: 0.9
        },
        {
          ax: 0, ay: 0, x: x2, y: y2,
          showarrow: true, arrowhead: 3, arrowsize: 1.2, arrowwidth: 2,
          arrowcolor: '#ff7f00', opacity: 0.9
        }
      ]
    };

    Plotly.react('plotly-container', traces, layout);
  }

  // initial draw and slider hooks
  draw(1.2,2.4,2.0,1.0);
  ['x1','y1','x2','y2'].forEach(id=>{
    document.getElementById(id).addEventListener('input',()=>{
      draw(
        +document.getElementById('x1').value,
        +document.getElementById('y1').value,
        +document.getElementById('x2').value,
        +document.getElementById('y2').value
      );
    });
  });
</script>
```


